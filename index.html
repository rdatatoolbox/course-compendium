<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Research Compendium</title>
    <meta charset="utf-8" />
    <meta name="author" content="  François Guilhaumon .inst[{{ Chercheur IRD }}]" />
    <script src="libs/header-attrs-2.11/header-attrs.js"></script>
    <link href="libs/font-awesome-5.15.3/css/all.min.css" rel="stylesheet" />
    <link href="libs/font-awesome-5.15.3/css/v4-shims.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="css/xaringan-themer.css" type="text/css" />
    <link rel="stylesheet" href="css/custom.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: right, middle, title-slide

# Research Compendium
## <i>ou comment bien ranger sa chambre</i>
### <br /><br />François Guilhaumon<br />.inst[{{ Chercheur IRD }}]
### .inst[Lundi 29 Novembre 2021]

---


class: inverse, center, middle

## Research Compendium


---

class: inverse, center, middle

## Research Compenkoi ?

---

class: inverse, center, middle

## Research Compendium

"A collection of concise but detailed information about a particular subject"

--

Un abrégé, un précis, un recueil. Il synthétise de manière exhaustive votre projet d'analyse de données.


---

## Research Compendium
&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;
- Quelques règles simples pour organiser son répertoire de travail

--

- Et pouvoir s'y retrouver (ou que les autres s'y retrouvent)

--

- Un jour vous allez partager votre code, vos données, vos résultats. Avec vous-même, avec vos étudiants, votre encadrant, vos collègues ou le reste du monde.

- Autant se préparer depuis le début plutôt que de devoir tout refaire ou risquer la honte internationale !

---

## Une définition formelle

&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;

.center[.big["The goal of a research compendium is to provide a standard and easily recognisable way
for organising the digital materials of a project to enable others to inspect, reproduce, and
extend the research."]]

---

## Principes
&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;
--

- Should organize its files according to the [...] conventions of (your) community (discipline or a lab). Following these conventions will help other people recognize the structure of the project, and also support tool building which takes advantage of the shared structure.

- Respectez les conventions de votre domaine si elles existent !

---

## Principes

--

- Should maintain a clear separation of .big[data, method, and output].
&lt;br/&gt;&lt;br/&gt;
This means data files must be separate from code files. Keeping data and method separate treats the data as “read-only,” so that the original data is untouched and all modifications are transparently documented in the code.
&lt;br/&gt;&lt;br/&gt;
The output files should be considered as disposable, with a mindset that one can always easily regenerate the output using the code and data.

.center[![](img/comp_1.png)]

---

## Principes

- Le flux d'analyses doit être séparé en étapes courtes (ou pas trop longues) et homogènes

--

- Numérotez les scripts, placez-y des entêtes

![](img/comp_2.png) ![:scale 70%](img/comp_3.png)

---

## Principes

- The relationship between which code operates on which data in which order to produce which outputs must be specified as well.

--

Utilisez un script "maître" (`make.R`) qui execute les étapes dans l'ordre (c'est le SEUL script R à la racine !)

.center[![:scale 40%](img/comp_4.png) ![:scale 40%](img/comp_make.png)]

---

## Principes

Utilisez un script "maître" (`make.R`) qui execute les étapes dans l'ordre (c'est le SEUL script R à la racine !)

--

Tous les scripts, "tournent" tous à partir de la racine du projet !

--

Tous les chemins (relatifs) seront définis à partir de la racine du projet !
&lt;br/&gt;
&lt;br/&gt;
.center[`res/1_datacleaned.csv` , `data/data_raw.csv`]

--

Cela peut poser des problèmes lors de la compilation des .Rmd situés à l'intérieur de votre arborescence. --&gt; Utilisez le package [`{here}`](https://here.r-lib.org)

.center[![:scale 35%](https://raw.githubusercontent.com/allisonhorst/stats-illustrations/master/rstats-artwork/here.png)]


---

## Principes


- L'utilisation d'un projet Rstudio permet de se retrouver à la racine du projet à son ouverture.

--
&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;
.center[SI VOUS UTILISEZ LA FONCTION SETWD() JE BRÛLE VOTRE ORDINATEUR !]

.center[![](img/comp_rproj.png)]

---

## Principes

- The relationship between which code operates on which data in which order to produce which outputs must be specified as well.

--

Chaque script écrit des résultats (fichiers) les référençant explicitement dans leur nom.

.center[e.g. le script "R/01_ingest_data.R" écrit des résultats du type "res/01_Zzz9Zzz9.truc"]

---

## Principes

-  Should specify the computational environment that was used for the original analysis. At its most basic, this could be a plain text file that includes a short list of the names and version numbers of the software and other critical tools used for the analysis. In more complex approaches, described below, the computational environment can be automatically preserved or reproduced as well.

--

Placez un README à la racine du projet

.center[![:scale 40%](img/comp_6.png)]

---

## Principes

--

-  Should specify the computational environment that was used for the original analysis. At its most basic, this could be a plain text file that includes a short list of the names and version numbers of the software and other critical tools used for the analysis. In more complex approaches, described below, the computational environment can be automatically preserved or reproduced as well.

--
&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;
Utilisez docker !

.center[<i class="fab fa-docker darkbig" role="presentation" aria-label="docker icon"></i>]


---

## Principes

- Séparons aussi le(s) documents de synthèse (papier, présentation, ...)

.center[![:scale 40%](img/comp_7.png)]


--

.center[Utilisez les packages rmarkdown, knitr, et rticles, ils sont puissants.]

---

## Principes

- Séparons aussi le(s) ressources utiles (biblio, etc ...)

.center[![:scale 40%](img/comp_8.png)]


---

## Diffusion / stockage

- Il existe de nombreuses plateformes pour stocker votre supp. mat.

- La plupat sont propriétaires/privées et/ou payantes (e.g. Dryad, https://datadryad.org/)

- Il existe Zenodo (https://zenodo.org/) : Il a été créé par OpenAIRE et le CERN pour fournir aux chercheurs un lieu pour déposer des ensembles de données. Il a été lancé en 2013, permettant à des chercheurs de télécharger des fichiers jusqu'à 50 GO.
&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;
.center[![:scale 40%](img/zenodo.png)]



---

## -&gt; vers le package R

- Finalement cette architecture n'est si différente de celle d'un package R !

- En intégrant les éléments essentiels de la structure d'un package on bénéficie de tous les outils développés dans ce contexte.
&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;
.center[![:scale 40%](img/comp_9.png)]


---

## Research Compendium (ressources)
&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;
- Marwick B, Boettiger C, Mullen L. 2018. Packaging data analytical work reproducibly using R (and friends). PeerJ Preprints 6:e3192v2 https://doi.org/10.7287/peerj.preprints.3192v2

- https://research-compendium.science/

- https://zenodo.org/communities/research-compendium/about/

- https://github.com/cboettig/template (structure de package)

- https://github.com/benmarwick/rrtools (structure de apckage + intégration docker !!)

---

## Limitation ...

--

- Il est compliqué, lorsque l'analyse n'est pas linéaire, de se souvenir de toutes les dépendances ...

- On est souvent ammener à refaire tourner l'ensemble des analyses ...

- Et si les calculs sont longs, cela devient vraient contre-productif !

.center[![:scale 40%](img/tweet.png)]
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="libs/macros.js"></script>
<script>var slideshow = remark.create({
"ratio": "4:3",
"highlightStyle": "zenburn",
"highlightLines": false,
"countIncrementalSlides": false,
"slideNumberFormat": "%current% / %total%"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
